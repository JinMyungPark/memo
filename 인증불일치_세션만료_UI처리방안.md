인증 불일치 또는 세션 만료에 따른 UI 처리 방안을 설계하는 과정은 사용자 경험(UX)과 보안성을 동시에 고려해야 합니다. 다음은 상세 설계 프로세스와 개발자에게 설명할 수 있는 방법입니다.

### 1. 프로세스 개요
인증 불일치 또는 세션 만료는 사용자와 시스템 간의 인증 상태가 더 이상 유효하지 않음을 의미합니다. 이러한 상태가 발생했을 때, 사용자는 적절하게 안내받고 필요한 조치를 취할 수 있어야 합니다.

### 2. 인증 불일치 또는 세션 만료 탐지
- **토큰 만료**: JWT와 같은 인증 토큰이 만료되었을 때 발생합니다.
- **세션 타임아웃**: 서버 측 세션이 타임아웃 되었을 때 발생합니다.
- **다른 기기에서 로그인**: 동일한 계정이 다른 기기에서 로그인이 발생해 현재 세션이 무효화되었을 때 발생합니다.

### 3. UI 처리 방안 설계

#### 3.1. 세션 만료 및 인증 불일치 탐지 시점
- **API 요청 시**: 각 API 호출에 대해 서버가 인증 불일치 또는 세션 만료를 감지할 수 있습니다.
- **주기적인 상태 확인**: 클라이언트 측에서 주기적으로 세션 상태를 확인하도록 설정할 수 있습니다.

#### 3.2. 사용자 알림 및 재인증 프로세스
1. **백그라운드 처리**
   - **자동 로그아웃 및 데이터 저장**: 만료된 세션이 탐지되면 클라이언트 측에서 사용자 작업 내용을 자동으로 저장하고, 사용자를 자동 로그아웃 처리합니다.
   - **재인증 요구 팝업**: 팝업이나 모달 윈도우를 통해 세션이 만료되었음을 사용자에게 알리고, "재로그인" 버튼을 제공합니다. 이 버튼을 클릭하면 로그인 페이지로 리디렉션됩니다.

2. **UI 컴포넌트**
   - **전체 페이지 리디렉션**: 중요한 작업이 아닌 경우, 세션이 만료되면 전체 페이지가 로그인 페이지로 리디렉션되도록 합니다.
   - **팝업 또는 모달 윈도우**:
     - 팝업을 통해 세션 만료를 알리고, "로그인 연장"과 "로그아웃" 버튼을 제공합니다.
     - 로그인 연장을 선택하면, 다시 인증 절차(예: 재로그인 또는 OTP 입력 등)를 거친 후 세션이 연장됩니다.
     - 로그아웃을 선택하면 사용자는 로그인 페이지로 리디렉션됩니다.

3. **사용자 작업 보호**
   - **작업 복구 지원**: 사용자 작업 중 세션이 만료되었다면, 재로그인 후에 사용자 작업을 복구하거나 해당 데이터를 자동 저장해 놓고 재로그인 후 복구할 수 있도록 합니다.
   - **경고 메시지**: 세션이 만료되기 일정 시간 전에 경고 메시지를 표시하여 사용자가 작업을 완료하거나 세션을 연장할 수 있도록 합니다.

#### 3.3. 에러 처리와 로깅
- **UI 에러 핸들링**: 인증 불일치 또는 세션 만료가 발생했을 때 이를 사용자에게 명확하게 알리는 에러 메시지를 표시합니다.
- **서버 측 로깅**: 세션 만료 또는 인증 불일치 이벤트는 서버 측에서 로그를 남겨, 이후 분석할 수 있도록 합니다.

### 4. 상세 설계 플로우

1. **사용자 요청 → 서버 응답(401 Unauthorized) → 클라이언트 측 이벤트 발생**:
   - 서버가 인증 불일치나 세션 만료 상태를 401 Unauthorized로 응답.
   - 클라이언트 측에서 해당 응답을 감지하여 UI 변경을 트리거.

2. **사용자 알림 및 처리**:
   - 자동 로그아웃 혹은 재인증 팝업 표시.
   - 사용자가 재로그인을 선택하면 로그인 화면으로 이동 또는 백그라운드에서 토큰 갱신 요청을 보내 새 토큰을 발급받음.

3. **재로그인 후 처리**:
   - 사용자가 정상적으로 로그인하면, 세션을 연장하고 사용자가 작업 중이던 화면으로 복귀.
   - 작업을 복구하거나, 이전 데이터를 유지한 상태로 페이지를 새로고침.

4. **로그아웃 시 처리**:
   - 로그아웃 버튼 선택 시, 모든 사용자 데이터를 정리하고 로그인 페이지로 리디렉션.

### 5. 개발자에게 설명

"이 UI 처리 방안은 사용자 경험을 해치지 않으면서도 보안성을 유지하기 위한 설계입니다. 세션 만료 시 백그라운드에서 사용자가 데이터를 잃지 않도록 자동 저장 기능을 구현하며, 즉각적인 재로그인을 유도하여 최소한의 사용자 불편을 목표로 합니다. 클라이언트 측에서 401 응답을 감지하여 즉시 UI를 업데이트하도록 하고, 사용자에게는 명확한 선택지를 제공하여 작업을 이어갈 수 있도록 합니다."

이런 방식으로 상세 설계를 문서화하고, 개발자가 이해하기 쉽게 플로우와 UI 컴포넌트의 동작 원리를 설명할 수 있습니다.
